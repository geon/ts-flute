var M=Object.defineProperty;var b=(r,e,i)=>e in r?M(r,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[e]=i;var m=(r,e,i)=>b(r,typeof e!="symbol"?e+"":e,i);(function(){"use strict";function r(o,s){class c extends AudioWorkletProcessor{constructor({processorOptions:a}){super();m(this,"toneOscilator");m(this,"midiMessages",[]);this.toneOscilator=s(a.sampleRate),this.toneOscilator.next(),this.port.onmessage=u=>{this.midiMessages.push(u.data)}}process(a,u,v){var h;const l=(h=u[0])==null?void 0:h[0];if(!l)throw new Error("Missing channel.");for(let f=0;f<l.length;f++)l[f]=this.toneOscilator.next(this.midiMessages.shift()).value;return!0}}registerProcessor(o,c)}function e(o){return 440*Math.pow(2,(o-69)/12)}const i="square-wave";function*d(o){let s=1;for(;;){for(let c=0;c<o;++c)yield s;s*=-1}}function*p(o){const s=new Map;for(;;){const n=yield[...s.values()].map(t=>t.next().value).reduce((t,a)=>t+a,0)*.15;if(n){let t=s.get(n.number);switch(n.type){case"noteon":{if(!t){const a=e(n.number);t=d(o/a*.5),s.set(n.number,t)}break}case"noteoff":{s.delete(n.number);break}}}}}function g(){r(i,p)}g()})();
